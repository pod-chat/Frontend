!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("react")):"function"==typeof define&&define.amd?define(["exports","react"],r):r((e="undefined"!=typeof globalThis?globalThis:e||self).ReactHookForm={},e.React)}(this,(function(e,r){"use strict";function t(e){if(e&&e.__esModule)return e;var r=Object.create(null);return e&&Object.keys(e).forEach((function(t){if("default"!==t){var n=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(r,t,n.get?n:{enumerable:!0,get:function(){return e[t]}})}})),r.default=e,Object.freeze(r)}var n=t(r),s=e=>"checkbox"===e.type,c=e=>null==e;const u=e=>"object"==typeof e;var i=e=>!c(e)&&!Array.isArray(e)&&u(e)&&!(e instanceof Date),a=e=>e.filter(Boolean),l=e=>void 0===e,o=(e={},r,t)=>{const n=a(r.split(/[,[\].]+?/)).reduce((e,r)=>c(e)?e:e[r],e);return l(n)||n===e?l(e[r])?t:e[r]:n};const f="blur",d="change",b="onBlur",y="onChange",g="onSubmit",h="onTouched",m="all",v="undefined",p="max",x="min",A="maxLength",O="minLength",j="pattern",k="required",V="validate";var R=(e,r)=>{const t=Object.assign({},e);return delete t[r],t};const F=n.createContext(null);F.displayName="RHFContext";const S=()=>n.useContext(F);var w=(e,r,t,n,s=!0)=>e?new Proxy(r,{get:(e,r)=>{if(r in e)return t.current[r]!==m&&(t.current[r]=!s||m),n&&(n.current[r]=!0),e[r]}}):r,_=e=>i(e)&&!Object.keys(e).length,C=(e,r,t)=>_(e)||Object.keys(e).length>=Object.keys(r).length||Object.keys(e).find(e=>r[e]===(!t||m)),D=typeof window!==v&&typeof window.HTMLElement!==v&&typeof document!==v;const E=D?"Proxy"in window:typeof Proxy!==v;function B(e){const r=S(),{formStateRef:t,formStateSubjectRef:s,readFormStateRef:c}=e&&e.control||r.control,[u,i]=n.useState(t.current),a=n.useRef({isDirty:!1,dirtyFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1});return n.useEffect(()=>{const e=s.current.subscribe({next:e=>{C(e,a.current)&&i(Object.assign(Object.assign({},t.current),e))}});return()=>e.unsubscribe()},[]),w(E,u,c,a,!1)}function N({name:e,rules:r,defaultValue:t,control:c,shouldUnregister:u}){const a=S(),{defaultValuesRef:b,register:y,fieldsRef:g,unregister:h,controllerSubjectRef:m,shouldUnmountUnregister:v}=c||a.control,{onChange:p,onBlur:x,ref:A}=y(e,r),[O,j]=n.useState(l(o(g.current,e)._f.value)?l(t)?o(b.current,e):t:o(g.current,e)._f.value),k=B({control:c||a.control});return o(g.current,e)._f.value=O,n.useEffect(()=>{const r=m.current.subscribe({next:r=>(!r.name||e===r.name)&&j(o(r.values,e))});return A({target:O}),()=>{r.unsubscribe(),(v||u)&&h(e)}},[e]),{field:{onChange:r=>{const t=(e=>i(e)&&e.target?s(e.target)?e.target.checked:e.target.value:e)(r);j(t),p({target:{value:t,name:e},type:d})},onBlur:()=>{x({target:{name:e},type:f})},name:e,value:O,ref:e=>e&&A(e)},formState:k,fieldState:Object.defineProperties({},{invalid:{get:()=>!!o(k.errors,e)},isDirty:{get:()=>!!o(k.dirtyFields,e)},isTouched:{get:()=>!!o(k.touchedFields,e)},error:{get:()=>o(k.errors,e)}})}}var $=(e,r,t,n,s)=>r?Object.assign(Object.assign({},t[e]),{types:Object.assign(Object.assign({},t[e]&&t[e].types?t[e].types:{}),{[n]:s||!0})}):{},M=e=>/^\w*$/.test(e),T=e=>a(e.replace(/["|']|\]/g,"").split(/\.|\[/));function I(e,r,t){let n=-1;const s=M(r)?[r]:T(r),c=s.length,u=c-1;for(;++n<c;){const r=s[n];let c=t;if(n!==u){const t=e[r];c=i(t)||Array.isArray(t)?t:isNaN(+s[n+1])?{}:[]}e[r]=c,e=e[r]}return e}const P=(e,r,t)=>{for(const n of t||Object.keys(e)){const t=o(e,n);if(t){const e=t._f,n=R(t,"_f");if(e&&r(e.name)){if(e.ref.focus&&l(e.ref.focus()))break;if(e.refs){e.refs[0].focus();break}}else i(n)&&P(n,r)}}},U=(e,r,t={})=>{for(const n in e.current){const s=e.current[n];if(s){const e=s._f,c=R(s,"_f");I(t,n,e?e.ref.disabled||e.refs&&e.refs.every(e=>e.disabled)?void 0:e.value:Array.isArray(s)?[]:{}),c&&U({current:c},r,t[n])}}return Object.assign(Object.assign({},r),t)};var W=e=>e.substring(0,e.search(/.\d/))||e,L=()=>{const e=typeof performance===v?Date.now():1e3*performance.now();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,r=>{const t=(16*Math.random()+e)%16|0;return("x"==r?t:3&t|8).toString(16)})},q=(e=[],r)=>e.map(e=>Object.assign({[r]:e&&e[r]||L()},e)),H=e=>c(e)||!u(e);function z(e,r,t){if(H(e)||H(r)||e instanceof Date||r instanceof Date)return e===r;if(!n.isValidElement(e)){const n=Object.keys(e),s=Object.keys(r);if(n.length!==s.length)return!1;for(const s of n){const n=e[s];if(!t||"ref"!==s){const e=r[s];if((i(n)||Array.isArray(n))&&(i(e)||Array.isArray(e))?!z(n,e,t):n!==e)return!1}}}return!0}function G(e,r,t,n,s){let c=-1;for(;++c<e.length;){for(const n in e[c])Array.isArray(e[c][n])?(!t[c]&&(t[c]={}),t[c][n]=[],G(e[c][n],o(r[c]||{},n,[]),t[c][n],t[c],n)):z(o(r[c]||{},n),e[c][n])?I(t[c]||{},n):t[c]=Object.assign(Object.assign({},t[c]),{[n]:!0});n&&!t.length&&delete n[s]}return t}var J=(e,r,t)=>function e(r,t){if(H(r)||H(t))return t;for(const n in t){const s=r[n],c=t[n];try{r[n]=i(s)&&i(c)||Array.isArray(s)&&Array.isArray(c)?e(s,c):c}catch(e){}}return r}(G(e,r,t.slice(0,e.length)),G(r,e,t.slice(0,e.length)));function K(e,r){return[...e,...Array.isArray(r)?r:[r]]}var Q=e=>Array.isArray(e)?Array(e.length).fill(void 0):void 0;function X(e,r,t){return[...e.slice(0,r),...Array.isArray(t)?t:[t],...e.slice(r)]}var Y=(e,r,t)=>Array.isArray(e)?(l(e[t])&&(e[t]=void 0),e.splice(t,0,e.splice(r,1)[0]),e):[];function Z(e,r){return[...Array.isArray(r)?r:[r],...e]}var ee=(e,r)=>l(r)?[]:function(e,r){let t=0;const n=[...e];for(const e of r)n.splice(e-t,1),t++;return a(n).length?n:[]}(e,(Array.isArray(r)?r:[r]).sort((e,r)=>e-r)),re=(e,r,t)=>{e[r]=[e[t],e[t]=e[r]][0]},te=e=>"boolean"==typeof e;function ne(e,r){const t=M(r)?[r]:T(r),n=1==t.length?e:function(e,r){const t=r.slice(0,-1).length;let n=0;for(;n<t;)e=l(e)?n++:e[r[n++]];return e}(e,t),s=t[t.length-1];let c;n&&delete n[s];for(let r=0;r<t.slice(0,-1).length;r++){let n,s=-1;const u=t.slice(0,-(r+1)),a=u.length-1;for(r>0&&(c=e);++s<u.length;){const r=u[s];n=n?n[r]:e[r],a===s&&(i(n)&&_(n)||Array.isArray(n)&&!n.filter(e=>i(e)&&!_(e)||te(e)).length)&&(c?delete c[r]:delete e[r]),c=n}}return e}function se(e,r){const t={};for(const n of e){const e=o(r,n);e&&(M(n)?t[n]=e._f:I(t,n,e._f))}return t}var ce=e=>"file"===e.type,ue=e=>"select-multiple"===e.type,ie=e=>"radio"===e.type;const ae={value:!1,isValid:!1},le={value:!0,isValid:!0};var oe=e=>{if(Array.isArray(e)){if(e.length>1){const r=e.filter(e=>e&&e.checked&&!e.disabled).map(e=>e.value);return{value:r,isValid:!!r.length}}return e[0].checked&&!e[0].disabled?e[0].attributes&&!l(e[0].attributes.value)?l(e[0].value)||""===e[0].value?le:{value:e[0].value,isValid:!0}:le:ae}return ae};const fe={isValid:!1,value:null};var de=e=>Array.isArray(e)?e.reduce((e,r)=>r&&r.checked&&!r.disabled?{isValid:!0,value:r.value}:e,fe):fe;function be(e){if(e&&e._f){const t=e._f.ref;if(t.disabled)return;return ce(t)?t.files:ie(t)?de(e._f.refs).value:ue(t)?(r=t.options,[...r].filter(({selected:e})=>e).map(({value:e})=>e)):s(t)?oe(e._f.refs).value:((e,{valueAsNumber:r,valueAsDate:t,setValueAs:n})=>r?""===e?NaN:+e:t?new Date(e):n?n(e):e)(l(t.value)?e._f.ref.value:t.value,e._f)}var r}var ye=e=>e&&(e.required||e.min||e.max||e.maxLength||e.minLength||e.pattern||e.validate),ge=e=>"function"==typeof e,he=e=>"string"==typeof e,me=e=>he(e)||n.isValidElement(e),ve=e=>e instanceof RegExp;function pe(e,r,t="validate"){if(me(e)||te(e)&&!e)return{type:t,message:me(e)?e:"",ref:r}}var xe=e=>i(e)&&!ve(e)?e:{value:e,message:""},Ae=async({_f:{ref:e,refs:r,required:t,maxLength:n,minLength:u,min:a,max:l,pattern:o,validate:f,name:d,value:b,valueAsNumber:y}},g)=>{const h={},m=ie(e),v=s(e),R=m||v,F=(y||ce(e))&&!e.value||""===b||Array.isArray(b)&&!b.length,S=$.bind(null,d,g,h),w=(r,t,n,s=A,c=O)=>{const u=r?t:n;h[d]=Object.assign({type:r?s:c,message:u,ref:e},S(r?s:c,u))};if(t&&(!m&&!v&&(F||c(b))||te(b)&&!b||v&&!oe(r).isValid||m&&!de(r).isValid)){const{value:n,message:s}=me(t)?{value:!!t,message:t}:xe(t);if(n&&(h[d]=Object.assign({type:k,message:s,ref:R?(r||[])[0]||{}:e},S(k,s)),!g))return h}if(!(c(a)&&c(l)||""===b)){let r,t;const n=xe(l),s=xe(a);if(isNaN(b)){const c=e.valueAsDate||new Date(b);he(n.value)&&(r=c>new Date(n.value)),he(s.value)&&(t=c<new Date(s.value))}else{const u=e.valueAsNumber||parseFloat(b);c(n.value)||(r=u>n.value),c(s.value)||(t=u<s.value)}if((r||t)&&(w(!!r,n.message,s.message,p,x),!g))return h}if(he(b)&&!F&&(n||u)){const e=xe(n),r=xe(u),t=!c(e.value)&&b.length>e.value,s=!c(r.value)&&b.length<r.value;if((t||s)&&(w(t,e.message,r.message),!g))return h}if(he(b)&&o&&!F){const{value:r,message:t}=xe(o);if(ve(r)&&!b.match(r)&&(h[d]=Object.assign({type:j,message:t,ref:e},S(j,t)),!g))return h}if(f){const t=R&&r?r[0]:e;if(ge(f)){const e=pe(await f(b),t);if(e&&(h[d]=Object.assign(Object.assign({},e),S(V,e.message)),!g))return h}else if(i(f)){let e={};for(const[r,n]of Object.entries(f)){if(!_(e)&&!g)break;const s=pe(await n(b),t,r);s&&(e=Object.assign(Object.assign({},s),S(r,s.message)),g&&(h[d]=e))}if(!_(e)&&(h[d]=Object.assign({ref:t},e),!g))return h}}return h},Oe=e=>({isOnSubmit:!e||e===g,isOnBlur:e===b,isOnChange:e===y,isOnAll:e===m,isOnTouch:e===h}),je=e=>e instanceof HTMLElement;class ke{constructor(){this.tearDowns=[]}add(e){this.tearDowns.push(e)}unsubscribe(){for(const e of this.tearDowns)e();this.tearDowns=[]}}class Ve{constructor(e,r){this.observer=e,this.closed=!1,r.add(()=>this.closed=!0)}next(e){this.closed||this.observer.next(e)}}class Re{constructor(){this.observers=[]}next(e){for(const r of this.observers)r.next(e)}subscribe(e){const r=new ke,t=new Ve(e,r);return this.observers.push(t),r}unsubscribe(){this.observers=[]}}const Fe=typeof window===v;e.Controller=e=>e.render(N(e)),e.FormProvider=e=>n.createElement(F.Provider,{value:R(e,"children")},e.children),e.appendErrors=$,e.get=o,e.set=I,e.useController=N,e.useFieldArray=({control:e,name:r,keyName:t="id",shouldUnregister:s})=>{const c=S(),u=n.useRef(""),{isWatchAllRef:i,watchFieldsRef:f,getIsDirty:d,watchSubjectRef:b,fieldArraySubjectRef:y,fieldArrayNamesRef:g,fieldsRef:h,defaultValuesRef:m,formStateRef:v,formStateSubjectRef:p,readFormStateRef:x,validFieldsRef:A,fieldsWithValidationRef:O,fieldArrayDefaultValuesRef:j,unregister:k,shouldUnmountUnregister:V}=e||c.control,[F,w]=n.useState(q(o(j.current,W(r))?o(j.current,r,[]):o(m.current,r,[]),t));I(j.current,r,[...F]),g.current.add(r);const _=e=>e.map(e=>R(e||{},t)),C=()=>{const e=o(U(h,m.current),r,[]);return q(o(j.current,r,[]).map((r,t)=>Object.assign(Object.assign({},r),e[t])),t)},D=(e,t)=>t?l(t.focusIndex)?t.focusName?t.focusName:t.shouldFocus?`${r}.${e}`:"":`${r}.${t.focusIndex}`:`${r}.${e}`,E=(e=[])=>w(q(e,t)),B=e=>!a(o(e,r,[])).length&&ne(e,r),N=(e,t,n=[],s=!0)=>{if(o(h.current,r)){const n=e(o(h.current,r),t.argA,t.argB);s&&I(h.current,r,n)}if(Array.isArray(o(v.current.errors,r))){const n=e(o(v.current.errors,r),t.argA,t.argB);s&&I(v.current.errors,r,n),B(v.current.errors)}if(x.current.touchedFields&&o(v.current.touchedFields,r)){const n=e(o(v.current.touchedFields,r),t.argA,t.argB);s&&I(v.current.touchedFields,r,n),B(v.current.touchedFields)}(x.current.dirtyFields||x.current.isDirty)&&(I(v.current.dirtyFields,r,J(_(n),o(m.current,r,[]),o(v.current.dirtyFields,r,[]))),(e=>{e&&I(v.current.dirtyFields,r,J(_(e),o(m.current,r,[]),o(v.current.dirtyFields,r,[])))})(n),B(v.current.dirtyFields)),x.current.isValid&&(I(A.current,r,e(o(A.current,r,[]),t.argA)),B(A.current),I(O.current,r,e(o(O.current,r,[]),t.argA)),B(O.current)),p.current.next({isDirty:d(r,_(n)),errors:v.current.errors,isValid:v.current.isValid})},$=(e,t=0,n="")=>e.forEach((e,s)=>!H(e)&&Object.entries(e).forEach(([e,c])=>{const u=`${n||r}.${n?s:t+s}.${e}`;Array.isArray(c)?$(c,s,u):I(h.current,u,{_f:{ref:{name:u},name:u,value:c}})}));return n.useEffect(()=>{if(i.current)p.current.next({});else for(const e of f.current)if(r.startsWith(e)){p.current.next({});break}b.current.next({name:r,value:o(U(h,m.current),r,[])}),u.current&&P(h.current,e=>e.startsWith(u.current)),u.current="",y.current.next({name:r,fields:_([...F])})},[F,r]),n.useEffect(()=>{const e=y.current.subscribe({next({name:e,fields:t,isReset:n}){n&&(e?I(j.current,e,t):j.current=t,E(o(j.current,r)))}});return!o(h.current,r)&&I(h.current,r,[]),()=>{e.unsubscribe(),(V||s)&&k(r)}},[]),{swap:n.useCallback((e,r)=>{const t=C();re(t,e,r),N(re,{argA:e,argB:r},t,!1),E(t)},[r]),move:n.useCallback((e,r)=>{const t=C();Y(t,e,r),E(t),N(Y,{argA:e,argB:r},t,!1)},[r]),prepend:n.useCallback((e,r)=>{const t=Array.isArray(e)?e:[e],n=Z(C(),t);E(n),N(Z,{argA:Q(e)},n),$(t),u.current=D(0,r)},[r]),append:n.useCallback((e,r)=>{const t=Array.isArray(e)?e:[e],n=K(C(),t),s=n.length-t.length;E(n),N(K,{argA:Q(e)},n,!1),$(t,s),u.current=D(s,r)},[r]),remove:n.useCallback(e=>{const t=ee(C(),e);(e=>{(Array.isArray(e)?e:[e]).forEach(e=>I(h.current,`${r}${l(e)?"":"."+e}`,l(e)?[]:void 0))})(e),E(t),N(ee,{argA:e},t)},[r]),insert:n.useCallback((e,r,t)=>{const n=Array.isArray(r)?r:[r],s=X(C(),e,n);E(s),N(X,{argA:e,argB:Q(r)},s),$(n,e),u.current=D(e,t)},[r]),fields:F}},e.useForm=function({mode:e=g,reValidateMode:r=y,resolver:t,context:u,defaultValues:i={},shouldFocusError:d=!0,shouldUnregister:b,criteriaMode:h}={}){const v=n.useRef({}),p=n.useRef(new Set),x=n.useRef(new Re),A=n.useRef(new Re),O=n.useRef(new Re),j=n.useRef(new Re),k=n.useRef({}),V=n.useRef(new Set),F=n.useRef(!1),S=n.useRef({}),B=n.useRef({}),N=n.useRef(i),$=n.useRef(!1),M=n.useRef(u),T=n.useRef(t),L=n.useRef(new Set),q=Oe(e),H=h===m,[G,K]=n.useState({isDirty:!1,isValidating:!1,dirtyFields:{},isSubmitted:!1,submitCount:0,touchedFields:{},isSubmitting:!1,isSubmitSuccessful:!1,isValid:!q.isOnSubmit,errors:{}}),Q=n.useRef({isDirty:!E,dirtyFields:!E,touchedFields:!E,isValidating:!E,isValid:!E,errors:!E}),X=n.useRef(G);M.current=u,T.current=t;const Y=()=>X.current.isValid=z(B.current,S.current)&&_(X.current.errors),Z=n.useCallback((e,r,t=!1,n={},s,u)=>{const i=o(X.current.errors,e);let a=t||!z(i,r,!0)||Q.current.isValid&&l(r)&&o(S.current,e)&&!o(B.current,e);if(r?(ne(B.current,e),a=a||!i||!z(i,r,!0),I(X.current.errors,e,r)):((o(S.current,e)||T.current)&&(I(B.current,e,!0),a=a||i),ne(X.current.errors,e)),a&&!c(t)||!_(n)||u){const e=Object.assign(Object.assign({},n),{isValid:T.current?!!s:Y(),errors:X.current.errors});X.current=Object.assign(Object.assign({},X.current),e),x.current.next(u?{}:e)}x.current.next({isValidating:!1})},[]),ee=n.useCallback((e,r,t={},n,u)=>{u&&_e(e);const i=o(v.current,e,{})._f;if(i){const u=D&&je(i.ref)&&c(r)?"":r;if(i.value=r,ie(i.ref)?(i.refs||[]).forEach(e=>e.checked=e.value===u):ce(i.ref)&&!he(u)?i.ref.files=u:ue(i.ref)?[...i.ref.options].forEach(e=>e.selected=u.includes(e.value)):s(i.ref)&&i.refs?i.refs.length>1?i.refs.forEach(e=>e.checked=Array.isArray(u)?!!u.find(r=>r===e.value):u===e.value):i.refs[0].checked=!!u:i.ref.value=u,n){const t=U(v);I(t,e,r),O.current.next({values:Object.assign(Object.assign({},N.current),t),name:e})}t.shouldDirty&&te(e,u),t.shouldValidate&&fe(e)}},[]),re=n.useCallback((e,r)=>{const t=U(v);return e&&r&&I(t,e,r),!z(t,N.current)},[]),te=n.useCallback((e,r,t=!0)=>{if(Q.current.isDirty||Q.current.dirtyFields){const n=!z(o(N.current,e),r),s=o(X.current.dirtyFields,e),c=X.current.isDirty;n?I(X.current.dirtyFields,e,!0):ne(X.current.dirtyFields,e),X.current.isDirty=re();const u={isDirty:X.current.isDirty,dirtyFields:X.current.dirtyFields},i=Q.current.isDirty&&c!==u.isDirty||Q.current.dirtyFields&&s!==o(X.current.dirtyFields,e);return i&&t&&x.current.next(u),i?u:{}}return{}},[]),ae=n.useCallback(async(e,r)=>{const t=(await Ae(o(v.current,e),H))[e];return Z(e,t,r),l(t)},[H]),le=n.useCallback(async(e,r=[])=>{const{errors:t}=await T.current(U(v,b?{}:N.current),M.current,{criteriaMode:h,names:r,fields:se(p.current,v.current)});for(const r of e){const e=o(t,r);e?I(X.current.errors,r,e):ne(X.current.errors,r)}return t},[h]),oe=async e=>{for(const r in e){const t=e[r];if(t){const e=t._f,r=R(t,"_f");if(e){const r=await Ae(t,H);r[e.name]?(I(X.current.errors,e.name,r[e.name]),ne(B.current,e.name)):o(S.current,e.name)&&(I(B.current,e.name,!0),ne(X.current.errors,e.name))}r&&await oe(r)}}},fe=n.useCallback(async e=>{const r=l(e)?Object.keys(v.current):Array.isArray(e)?e:[e];let t;return x.current.next({isValidating:!0}),t=T.current?_(await le(r,l(e)?void 0:r)):!!(l(e)?await oe(v.current):(await Promise.all(r.filter(e=>o(v.current,e)).map(async e=>await ae(e,null)))).every(Boolean)),x.current.next({errors:X.current.errors,isValidating:!1,isValid:T.current?t:Y()}),t},[le,ae]),de=n.useCallback((e,r,t)=>Object.entries(r).forEach(([r,n])=>{const s=`${e}.${r}`,c=o(v.current,s);c&&!c._f?de(s,n,t):ee(s,n,t,!0,!c)}),[fe]),me=e=>$.current||V.current.has(e)||V.current.has((e.match(/\w+/)||[])[0]),ve=(e,r,t,n)=>{const s=o(v.current,e),c=l(s._f.value)?o(N.current,e):s._f.value;return s&&!l(c)&&(t&&t.defaultChecked?s._f.value=be(s):L.current.size&&[...L.current].find(r=>e.startsWith(r))?s._f.value=c:ee(e,c)),(!l(c)||n)&&ye(r)&&!q.isOnSubmit&&s&&Q.current.isValid&&Ae(s,H).then(r=>{_(r)?I(B.current,e,!0):ne(B.current,e),X.current.isValid!==Y()&&K(Object.assign(Object.assign({},X.current),{isValid:Y()}))}),c},pe=n.useCallback(async({type:e,target:t,target:{value:n,type:c}})=>{let u,i,a=t.name;const d=o(v.current,a);if(d){let y=c?be(d):void 0;y=l(y)?n:y;const g=e===f,{isOnBlur:m,isOnChange:p}=Oe(r),O=!ye(d._f)&&!T.current&&!o(X.current.errors,a)||(({isOnBlur:e,isOnChange:r,isOnTouch:t,isTouched:n,isReValidateOnBlur:s,isReValidateOnChange:c,isBlurEvent:u,isSubmitted:i,isOnAll:a})=>!a&&(!i&&t?!(n||u):(i?s:e)?!u:!(i?c:r)||u))(Object.assign({isBlurEvent:g,isTouched:!!o(X.current.touchedFields,a),isSubmitted:X.current.isSubmitted,isReValidateOnBlur:m,isReValidateOnChange:p},q)),j=!g&&me(a);l(y)||(d._f.value=y);const k=te(a,d._f.value,!1);g&&!o(X.current.touchedFields,a)&&(I(X.current.touchedFields,a,!0),Q.current.touchedFields&&(k.touchedFields=X.current.touchedFields));let V=!_(k)||j;if(O)return!g&&A.current.next({name:a,type:e,value:y}),V&&x.current.next(j?{}:k);if(x.current.next({isValidating:!0}),T.current){const{errors:e}=await T.current(U(v,b?{}:N.current),M.current,{criteriaMode:h,fields:se([a],v.current),names:[a]}),r=X.current.isValid;if(u=o(e,a),s(t)&&!u){const r=W(a),t=o(e,r,{});t.type&&t.message&&(u=t),(t||o(X.current.errors,r))&&(a=r)}i=_(e),r!==i&&(V=!0)}else u=(await Ae(d,H))[a];!g&&A.current.next({name:a,type:e,value:y}),Z(a,u,V,k,i,j)}},[]),xe=e=>{const r=F.current?U(v,b?{}:N.current):N.current;return l(e)?r:he(e)?o(r,e):e.map(e=>o(r,e))},ke=n.useCallback(async(e={})=>{const r=X.current.isValid;if(t){const{errors:r}=await T.current(Object.assign(Object.assign({},U(v,b?{}:N.current)),e),M.current,{criteriaMode:h,fields:se(p.current,v.current)});X.current.isValid=_(r)}else Y();r!==X.current.isValid&&x.current.next({isValid:X.current.isValid})},[h]),Ve=n.useCallback((e,r,t)=>{const n=Array.isArray(e),s=F.current?xe():l(r)?N.current:n?r||{}:{[e]:r};if(l(e))return t&&($.current=!0),s;const c=[];for(const r of n?e:[e])t&&V.current.add(r),c.push(o(s,r));return n?c:c[0]},[]),Se=(e,r={},t)=>{for(const n of e?Array.isArray(e)?e:[e]:Object.keys(p.current))p.current.delete(n),L.current.delete(n),o(v.current,n)&&(r.keepIsValid||(ne(S.current,n),ne(B.current,n)),!r.keepError&&ne(X.current.errors,n),!r.keepValue&&ne(v.current,n),!r.keepDirty&&ne(X.current.dirtyFields,n),!r.keepTouched&&ne(X.current.touchedFields,n),(!b||t)&&!r.keepDefaultValue&&ne(N.current,n),t&&A.current.next({name:n}));t&&(x.current.next(Object.assign(Object.assign(Object.assign({},X.current),r.keepDirty?{isDirty:re()}:{}),T.current?{}:{isValid:Y()})),!r.keepIsValid&&ke())},we=(e,r,t)=>{_e(e);let n=o(v.current,e);const c=(e=>ie(e)||s(e))(r);if(r===n._f.ref||D&&je(n._f.ref)&&!je(r)||c&&Array.isArray(n._f.refs)&&a(n._f.refs).find(e=>e===r))return;n={_f:c?Object.assign(Object.assign({},n._f),{refs:[...a(n._f.refs||[]).filter(e=>je(e)&&document.contains(e)),r],ref:{type:r.type,name:e}}):Object.assign(Object.assign({},n._f),{ref:r})},I(v.current,e,n);const u=ve(e,t,r,!0);(c&&Array.isArray(u)?!z(o(v.current,e)._f.value,u):l(o(v.current,e)._f.value))&&(o(v.current,e)._f.value=be(o(v.current,e)))},_e=n.useCallback((e,r)=>{const t=!o(v.current,e);return I(v.current,e,{_f:Object.assign(Object.assign(Object.assign({},t?{ref:{name:e}}:Object.assign({ref:(o(v.current,e)._f||{}).ref},o(v.current,e)._f)),{name:e}),r)}),ye(r)&&I(S.current,e,!0),p.current.add(e),t&&ve(e,r),Fe?{name:e}:{name:e,onChange:pe,onBlur:pe,ref:t=>t?we(e,t,r):(b||r&&r.shouldUnregister)&&Se(e)}},[N.current]),Ce=n.useCallback((e,r)=>async t=>{t&&(t.preventDefault&&t.preventDefault(),t.persist&&t.persist());let n=Object.assign(Object.assign({},b?{}:N.current),U(v));x.current.next({isSubmitting:!0});try{if(T.current){const{errors:e,values:r}=await T.current(n,M.current,{criteriaMode:h,fields:se(p.current,v.current)});X.current.errors=e,n=r}else await oe(v.current);_(X.current.errors)&&Object.keys(X.current.errors).every(e=>o(n,e))?(x.current.next({errors:{},isSubmitting:!0}),await e(n,t)):(r&&await r(X.current.errors,t),d&&P(v.current,e=>o(X.current.errors,e),p.current))}finally{X.current.isSubmitted=!0,x.current.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:_(X.current.errors),submitCount:X.current.submitCount+1,errors:X.current.errors})}},[d,H,h]),De=n.useCallback(({keepErrors:e,keepDirty:r,keepIsSubmitted:t,keepTouched:n,keepDefaultValues:s,keepIsValid:c,keepSubmitCount:u},i)=>{c||(B.current={},S.current={}),V.current=new Set,$.current=!1,x.current.next({submitCount:u?X.current.submitCount:0,isDirty:r?X.current.isDirty:!!s&&z(i,N.current),isSubmitted:!!t&&X.current.isSubmitted,isValid:c?X.current.isValid:!!ke(i),dirtyFields:r?X.current.dirtyFields:{},touchedFields:n?X.current.touchedFields:{},errors:e?X.current.errors:{},isSubmitting:!1,isSubmitSuccessful:!1})},[]);return n.useEffect(()=>{const e=x.current.subscribe({next(e={}){C(e,Q.current,!0)&&(X.current=Object.assign(Object.assign({},X.current),e),K(X.current))}}),r=j.current.subscribe({next(e){if(e.fields&&e.name&&Q.current.isValid){const r=U(v);I(r,e.name,e.fields),ke(r)}}});return T.current&&Q.current.isValid&&ke(),()=>{A.current.unsubscribe(),e.unsubscribe(),r.unsubscribe()}},[]),n.useEffect(()=>{F.current=!0}),{control:n.useMemo(()=>({register:_e,isWatchAllRef:$,watchFieldsRef:V,getIsDirty:re,formStateSubjectRef:x,fieldArraySubjectRef:j,controllerSubjectRef:O,watchSubjectRef:A,watchInternal:Ve,fieldsRef:v,validFieldsRef:B,fieldsWithValidationRef:S,fieldArrayNamesRef:L,readFormStateRef:Q,formStateRef:X,defaultValuesRef:N,fieldArrayDefaultValuesRef:k,unregister:Se,shouldUnmountUnregister:b}),[]),formState:w(E,G,Q),trigger:fe,register:_e,handleSubmit:Ce,watch:n.useCallback((e,r)=>ge(e)?A.current.subscribe({next:t=>e(Ve(void 0,r),t)}):Ve(e,r,!0),[]),setValue:n.useCallback((e,r,t={})=>{const n=o(v.current,e),s=L.current.has(e);s&&(j.current.next({fields:r,name:e,isReset:!0}),(Q.current.isDirty||Q.current.dirtyFields)&&t.shouldDirty&&(I(X.current.dirtyFields,e,J(r,o(N.current,e,[]),o(X.current.dirtyFields,e,[]))),x.current.next({dirtyFields:X.current.dirtyFields,isDirty:re(e,r)})),!r.length&&I(v.current,e,[])&&I(k.current,e,[])),n&&!n._f||s?de(e,r,s?{}:t):ee(e,r,t,!0,!n),me(e)&&x.current.next({}),A.current.next({name:e,value:r})},[de]),getValues:n.useCallback(xe,[]),reset:n.useCallback((e,r={})=>{const t=e||N.current;if(D&&!r.keepValues)for(const e of p.current){const r=o(v.current,e);if(r&&r._f){const e=Array.isArray(r._f.refs)?r._f.refs[0]:r._f.ref;if(je(e))try{e.closest("form").reset();break}catch(e){}}}!r.keepDefaultValues&&(N.current=Object.assign({},t)),r.keepValues||(v.current={},O.current.next({values:Object.assign({},t)}),A.current.next({value:Object.assign({},t)}),j.current.next({fields:Object.assign({},t),isReset:!0})),De(r,e),F.current=!1},[]),clearErrors:n.useCallback(e=>{e&&(Array.isArray(e)?e:[e]).forEach(e=>ne(X.current.errors,e)),x.current.next({errors:e?X.current.errors:{}})},[]),unregister:n.useCallback((e,r={})=>Se(e,r,!0),[]),setError:n.useCallback((e,r,t)=>{const n=((o(v.current,e)||{_f:{}})._f||{}).ref;I(X.current.errors,e,Object.assign(Object.assign({},r),{ref:n})),x.current.next({errors:X.current.errors,isValid:!1}),t&&t.shouldFocus&&n&&n.focus&&n.focus()},[]),setFocus:n.useCallback(e=>o(v.current,e)._f.ref.focus(),[])}},e.useFormContext=S,e.useFormState=B,e.useWatch=function(e){const{control:r,name:t,defaultValue:s}=e||{},c=S(),u=n.useRef(t);u.current=t;const{watchInternal:i,watchSubjectRef:a}=r||c.control,[o,f]=n.useState(l(s)?i(t):s);return n.useEffect(()=>{i(t);const e=a.current.subscribe({next:({name:e,value:r})=>(!u.current||!e||(Array.isArray(u.current)?u.current:[u.current]).some(r=>e&&r&&(r.startsWith(e)||e.startsWith(r))))&&f(he(e)&&u.current===e&&!l(r)?r:i(u.current,s))});return()=>e.unsubscribe()},[]),o},Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=index.umd.js.map
